Here are **detailed notes on Ingress in Kubernetes**, covering **all major concepts**, **architecture**, **components**, **YAML examples**, **advanced features**, and **interview questions**. This guide also includes **links to official Kubernetes documentation** for deeper study.

---

# 🚪 Kubernetes Ingress – Detailed Notes

---

## 🔹 What is Ingress in Kubernetes?

> Ingress is an **API object** in Kubernetes that **manages external access to services** within a cluster, typically over **HTTP/HTTPS**.

### 🔧 In simple terms:

* Ingress is like a **smart router** for Kubernetes services.
* It defines **rules** for routing **HTTP/S traffic** to different services based on the **host** or **URL path**.

📚 **Official Doc:**
[Kubernetes Ingress Documentation](https://kubernetes.io/docs/concepts/services-networking/ingress/)

---

## 🔹 Why Use Ingress?

| Feature             | Benefit                                    |
| ------------------- | ------------------------------------------ |
| Centralized routing | One point of access to many services       |
| SSL termination     | Manage HTTPS in one place                  |
| Path-based routing  | `/app1` → service1, `/app2` → service2     |
| Host-based routing  | `foo.com` → serviceA, `bar.com` → serviceB |
| TLS/HTTPS Support   | Add secure access with certs               |
| Custom rules        | Fine-grained control on traffic            |
| Load balancing      | Balances traffic among pods                |

---

## 🔹 Key Components

| Component              | Description                                                              |
| ---------------------- | ------------------------------------------------------------------------ |
| **Ingress**            | Kubernetes object containing routing rules                               |
| **Ingress Controller** | The actual implementation that enforces ingress rules                    |
| **Backend Service**    | The target Kubernetes service                                            |
| **IngressClass**       | Defines which Ingress Controller will process the resource (e.g., NGINX) |

---

## 🔹 How Ingress Works (Diagram)

```
        +---------+         +-----------------+
        |  User   |  --->   | Ingress (Rules) |
        +---------+         +-----------------+
                                 |
                +------------------------------+
                |       Ingress Controller     |
                +------------------------------+
                 |        |            |
              /app1    /app2      /login
                ↓         ↓           ↓
           Service-A  Service-B  Service-C
```

---

## 🔹 Ingress vs Service vs LoadBalancer

| Feature            | ClusterIP | NodePort | LoadBalancer | Ingress |
| ------------------ | --------- | -------- | ------------ | ------- |
| Internal traffic   | ✅         | ❌        | ❌            | ❌       |
| External access    | ❌         | ✅        | ✅            | ✅       |
| Path-based routing | ❌         | ❌        | ❌            | ✅       |
| TLS termination    | ❌         | ❌        | ❌            | ✅       |

---

## 🔹 Types of Ingress Routing

### 1. **Path-based routing**

```yaml
rules:
  - http:
      paths:
        - path: /app1
          pathType: Prefix
          backend:
            service:
              name: app1-service
              port:
                number: 80
```

### 2. **Host-based routing**

```yaml
rules:
  - host: app.example.com
    http:
      paths:
        - path: /
          pathType: Prefix
          backend:
            service:
              name: app-service
              port:
                number: 80
```

### 3. **Combined**

```yaml
rules:
  - host: shop.example.com
    http:
      paths:
        - path: /cart
          pathType: Prefix
          backend:
            service:
              name: cart-service
              port:
                number: 80
```

---

## 🔹 Example: Simple Ingress YAML

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: my-ingress
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
    - host: example.com
      http:
        paths:
          - path: /app
            pathType: Prefix
            backend:
              service:
                name: my-service
                port:
                  number: 80
```

---

## 🔹 TLS/HTTPS Ingress

```yaml
spec:
  tls:
    - hosts:
        - example.com
      secretName: tls-secret
```

🔐 TLS certificates must be stored in **Kubernetes Secrets**.
🛠️ Use `cert-manager` for auto TLS via Let's Encrypt.

📚 [TLS Ingress Doc](https://kubernetes.io/docs/concepts/services-networking/ingress/#tls)

---

## 🔹 Ingress Annotations

Annotations let you customize behavior:

| Annotation Key                                       | Purpose               |
| ---------------------------------------------------- | --------------------- |
| `nginx.ingress.kubernetes.io/rewrite-target`         | Rewrites the URL path |
| `nginx.ingress.kubernetes.io/ssl-redirect`           | Force HTTPS           |
| `nginx.ingress.kubernetes.io/auth-type`              | Enable basic auth     |
| `nginx.ingress.kubernetes.io/whitelist-source-range` | IP whitelist          |

📚 [Full NGINX Annotations List](https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/)

---

## 🔹 Ingress Controller

### What is it?

It’s a **pod running in the cluster** that watches Ingress objects and manages routing.

### Popular Ingress Controllers:

* ✅ **NGINX Ingress Controller** (most widely used)
* ✅ HAProxy Ingress
* ✅ Traefik
* ✅ Istio Gateway
* ✅ AWS/GCP/Azure Ingress Controller (cloud-specific)

📚 [NGINX Ingress Controller](https://kubernetes.github.io/ingress-nginx/)

---

## 🔹 IngressClass

Used to support **multiple ingress controllers**.

```yaml
apiVersion: networking.k8s.io/v1
kind: IngressClass
metadata:
  name: nginx
spec:
  controller: k8s.io/ingress-nginx
```

Then specify it in your Ingress:

```yaml
spec:
  ingressClassName: nginx
```

📚 [IngressClass Doc](https://kubernetes.io/docs/concepts/services-networking/ingress/#ingress-class)

---

## 🔹 Advanced Ingress Features

| Feature               | Description                                   |
| --------------------- | --------------------------------------------- |
| **Rate Limiting**     | Control request rates to backends             |
| **Rewrite URLs**      | Modify request URL using regex                |
| **Authentication**    | Basic auth, OAuth with annotations            |
| **Canary Releases**   | Route % of traffic to new versions            |
| **WebSocket Support** | Ingress controllers support WebSocket routing |
| **gRPC Support**      | HTTP2-based gRPC routing                      |

---

## 🔹 Common Errors & Fixes

| Issue               | Cause                      | Fix                                         |
| ------------------- | -------------------------- | ------------------------------------------- |
| 404 Not Found       | Service not matched        | Check path, pathType, and service name      |
| TLS not working     | No secret found            | Ensure correct TLS secret in same namespace |
| Ingress not routing | Missing controller         | Deploy ingress controller like NGINX        |
| Port not open       | NodePort or firewall issue | Expose Ingress via LoadBalancer or port     |

---

## 🔹 Useful kubectl Commands

```bash
# List ingress objects
kubectl get ingress

# Describe an ingress
kubectl describe ingress my-ingress

# Get ingress logs (NGINX)
kubectl logs -n ingress-nginx deploy/ingress-nginx-controller

# View ingress routes
kubectl get ingress -o wide
```

---

## 🔹 Real-world Use Case Example

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: shop-ingress
spec:
  tls:
    - hosts:
        - shop.example.com
      secretName: tls-shop
  rules:
    - host: shop.example.com
      http:
        paths:
          - path: /products
            pathType: Prefix
            backend:
              service:
                name: product-service
                port:
                  number: 80
          - path: /cart
            pathType: Prefix
            backend:
              service:
                name: cart-service
                port:
                  number: 80
```

---

## ✅ Interview Preparation Questions

1. What is Ingress in Kubernetes?
2. How is Ingress different from LoadBalancer?
3. What is an Ingress Controller and name some examples?
4. How do you enable TLS with Ingress?
5. What are annotations in Ingress used for?
6. Explain path-based vs host-based routing.
7. What happens if multiple Ingress resources share the same host?
8. What is the purpose of IngressClass?
9. How can you implement authentication with Ingress?
10. How does Ingress handle canary deployments?

---

Let me know if you want a **hands-on lab setup guide**, **cert-manager TLS auto-provisioning**, or **Ingress + Istio gateway** configuration.
